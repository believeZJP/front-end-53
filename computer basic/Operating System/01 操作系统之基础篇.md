## 概述
1. 无操作系统阶段
    > 人工操作  
    > 用户独占  
    > CPU等待人工操作    
    > 资源利用率低
2. 批处理系统阶段
    > 无需等待人工操作  
    > 批量输入任务  
    > 资源利用率提升    
    > 多道程序设计
3. 分时系统阶段
    > 人机交互  
    > 多用户共享  
    > 即时调试程序  
    > 资源利用率提升  

#### 多道程序设计
- 多道程序设计是指在计算机内存中同时存放多个程序
- 多道程序在计算机的管理程序下相互穿插运行

这涉及到五大功能：进程管理，存储管理，作业管理，文件管理，设备管理。

## 操作系统概述
操作系统是管理计算机硬件和软件资源的的计算机程序
- 管理配置内存、决定资源供需顺序、控制输入输出设备等
- 操作系统提供让用户和系统交互的操作界面

管理硬件、提供用户交互的软件系统

## 进程管理之进程实体
在没有操作系统之前，资源只是属于当前运行的程序，也就是说，计算机只能一次运行一个程序。  
进程其实就是合理的隔离资源、运行环境，提升资源利用率。

#### 为什么需要进程
- 进程是系统进行资源分配和调度的基本单位
- 进程作为程序独立运行的载体保障程序征程执行
- 进程的存在使得操作系统资源的利用率大幅提升

## 进程的实体
#### 主存中的进程形态
进程在主存中也是一段连续存储的空间，叫做进程控制块（PCB），每个控制块有很多重要的信息，下面说明：
- 标识符：唯一标记一个进程，用于区别其他进程
- 状态：标记进程的运行状态，如：运行态
- 程序计数器：指向即将执行的下一条指令的地址
- 内存指针：程序代码、进程数据相关指针
- 上下文数据：进程执行时处理器存储的数据
- IO状态信息：被进程IO操作所占用的文件列表
- 记账信息：使用处理器时间、时钟数总和等

上面的信息可以归结为4类：进程标识符，处理机状态，进程调度信息，进程控制信息

PCB：
- 用于描述和控制进程运行的通用数据结构
- 记录进程当前状态和控制进程运行的全部信息
- PCB使得进程是能够独立运行的基本单位
- PCB是操作系统进行调度经常被读取的信息
- PCB是常驻内存的，存放在系统专门开辟的PCB区域内

#### 进程和线程
一个进程可以有多个线程，线程是操作系统进行运行调度的最小单位；包含在进程之中，是进程中实际运行工作的单位；线程可以并发。

![](https://raw.githubusercontent.com/clown-0726/mypicsbed/master/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%AF%94%E8%BE%83.png)

进程的线程共享进程资源。

## 进程的五状态模型
创建，终止，就绪，阻塞，执行  
就绪队列：在一个系统中多个处于就绪状态的进程通常排成一个队列  
阻塞队列：同样也存在多个处于阻塞状态的进程组成一个阻塞队列

![](https://raw.githubusercontent.com/clown-0726/mypicsbed/master/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%9B%E7%A8%8B%E7%9A%84%E4%BA%94%E7%8A%B6%E6%80%81%E6%A8%A1%E5%9E%8B%E5%88%87%E6%8D%A2%E5%85%B3%E7%B3%BB.png)

- 就绪状态
    > 当进程被分配到除CPU以外所有必要的资源后
    > 只要再获得CPU的使用权，就可以立即运行
    > 其他资源都准备好，只差CPU资源的状态为就绪状态
- 执行状态
    > 进程获得CPU，其程序正在执行称为执行状态
    > 在单处理机中，在某个时刻只能有一个进程是处于执行状态
- 阻塞状态
    > 进程因某种原因如：其他设备未就绪而无法继续执行
    > 从而放弃CPU的状态称为阻塞状态
- 创建状态
    > 创建进程时拥有PCB但其他资源尚未就绪的状态称为创建状态
    > 分配PCB -> 插入就绪队列
- 创建状态
    > 进程结束由系统清理或者归还PCB的状态称为终止状态
    > 系统清理 -> PCB归还

## 进程之间的同步
为什么需要进程之间的同步，可以思考生产者-消费者模型，这个模型必须需要进程同步。还有“哲学家进餐”问题。

临界资源：临界资源指的是一些虽作为共享资源却又无法同时被多个线程共同访问的共享资源。当有进程在使用临界资源时，其他进程必须依据操作系统的同步机制等待占用进程释放该资源才可重新竞争使用资源。

进程间的同步四个原则：
- 空闲让进：资源无占用，允许使用
- 忙则等待：资源有占用，请求进程等待
- 有限等待：保证有限等待时间能够使用资源
- 让权等待：等待时，进程需要让出CPU

进程之间同步的方法：
- 消息队列
- 共享存储
- 信号量

和进程一样，进程内多线程也需要同步。

线程的同步的方法：
- 互斥量
- 读写锁
- 自旋锁
- 条件变量

![](https://raw.githubusercontent.com/clown-0726/mypicsbed/master/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%A0%87%E8%AE%B0.png)

## linux的进程管理：
linux进程分类
- 前台进程，具有终端，可以和用户交互的进程
- 后台进程，没有占用终端的就是后台进程，相应的，不和用户交互，其优先级比前台进程低一些，一般使用 & 符号
- 守护进程（特殊的后台进程）


```
&: 后面机上&后是守护进程，但是这个守护进程是bash启动的，bash是这个进程当父进程，当bash停止当时候，这个守护进程也会停止。（如果守护进程的日志不重定向当话，其结果也会继续输出到bash的）

nohup: nohup其实就是断绝父子进程的关系，当bash关闭的时候，进程还在继续运行。

ps: 查看当前bash的进程创建的子进程
ps -aux: 最常用的查看进程的命令
ps -u root -aux: 指定用户查看进程
ps -ef --forest: 查看进程之间的父子关系
```